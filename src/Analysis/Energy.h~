#ifndef ENERGY_H
#define ENERGY_H

#include <NBody.h>

namespace NBody
{
    /// The type of orbits in the system.
    enum Orbit { Radial, Isotropic };
        
    /// Calculate the gravitational potential energy by direct summation.
    /// Don't use this for more than ~10000 particles!
    void CalcPotDirect(System &S, double eps = 0.0);
    
    /// Calculate the gravitational potential energy by assuming the
    /// system is spherically symmetric.  The system MUST be sorted
    /// by radius before this function is called.
    void CalcPotShell(System &S, double eps = 0.0);
    
    /// Calculate the energy of each particle, E = v^2/2 + Phi.
    /// Phi should be calculate and stored in the particle data.
    void CalcEnergy(const System &S, double *E, double &Etot);
    
    /// Calculate the differential energy distribution
    void DiffEnergyDistNorm(const System &S, const double *E, double *Ebin,
                            double *Mbin, int NumBins);
    
    /// Calculate the differential energy distribution using bins of equal
    /// mass.
    void DiffEnergyDistEqual(System &S, const double *E, double *Ebin,
                             double *Mbin, int NumBins);
    
    /// Calculate the number density N(E, j).  Nbin is an array
    /// of length NumBins * NumBins.
    void NumberDensity(const System &S, const double *E, double *Ebin, 
                       double *Jbin, double *Nbin, int NumBins);
    
    /// Calculate the density of states, g(E)
    void DenStates(const System &S, double *g, const double *Ebin, 
                   int NumBins, Orbit orbit);

}  

#endif
